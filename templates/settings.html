{% extends "layout.html" %}
{% block content %}
<p>
<!---------------------------------------------------------------------------------->
<form action="/settings/change_user_name" method="POST">
<h2 style="color:green">Omat tiedot hallinta</h2>
<p>
Tunnuksesi on: {{ user_info[0] }}<br>
Kalenterissa näkyvä nimesi on: {{ user_info[1] }}<br>
Yhteystietosi adminille: {% if user_info[2] %} {{ user_info[2] }} {% endif %}<br>
<p>
<b>Vaihda kalenterissa näkyvä nimesi*</b> <br>
Anna uusi nimi:<br>
<input type="text" name="name" minlength="2" maxlength="30">
<br>*Huom! tunnus ei muutu, vain kalenterissa näkyvä nimi muuttuu. Oletuksena muille jäsenille näkyy rekisteröinnissä antamasi tunnus nimenäsi.
Voit halutessasi vaihtaa kalenterissa näkyvää nimeäsi, kirjautumistunnuksesi säilyy silti ennallaan.<br>
Nimi päivittyy heti uusiin viesteihin ja ilmoittautumisiin, ja ylhäälle näkymään kirjautuneena seuraavassa sisäänkirjautumisessa.
<p>
    <input type="submit" value="Tallenna muutos">
    <p>
    </form>
<p>
<!--------------------------------------------------------------------------->
<form action="/settings/change_contact_info" method="POST">

Yhteystietoni vain adminin/adminien tietoon: <br>
<input type="text" name="contact_info">
<p>
    <input type="submit" value="Tallenna muutos">
    <p>
    </form>
<!--------------------------------------------------------------------->
<form action="/settings/change_password" method="POST">

<b>Salasanan vaihto:</b>
<p>
Vanha salasana:<br><input type="password" name="old_password">
<p>
Uusi salasana:<br><input type="password" name="new_password1">
<p>
Uusi salasana uudelleen: <br><input type="password" name="new_password2">
<input type="hidden" name="csrf_token" value="{{session.csrf_token}}">
<p>
<input type="submit" value="Tallenna muutos">
<p>
</form>
<hr>
<!-------------------------------------------------------------------->
<!-- TÄHÄN ASTI nyt jäsenille näkyvät jäsenen asetukset-->
<!-------------------------------------------------------------------------->


<!-- alla muutamia toiminnaltaan osittain valmiita asetustoimintoja jäsenelle, näkyy nyt vain adminina/ryhmän perustajana -->
{% if session["user_role"] == 1 or session["user_role"] == 0 %}
<!--(siirrä yllä olevaa adminin oikeusriviä, kun allaolevia jäsenelle kuuluvia asetuksia valmiina)-->
-------------
<h4 style="color:green">Alla näkyvistä ominaisuuksista suurin osa vasta luonnostelmia tai ei testattu toimintaa riittävästi<br>
Vihreällä otsikoidut ovat kokeiltavaksi valmiita ominaisuuksia.</h4>
-------------
<p>
<form action="/settings/weekly_entries" method="POST">
<h2>Viikottaiset vakio-osallistumisajat</h2>
##lisää peruminen, toimii muuten ok, tarkista vielä..<br>
<p>
Lisään uuden viikottaisen vakioajan tapahtumalle:<br>
<select name="weekly_event">
    {% for event in events_with_own_level %}
    <option value="{{event[0]}}">{{event[1]}}
    {% endfor %}
</select>
viikonpäivä
<select name="weekly_dow">
    <option value="1">MA
    <option value="2">TI
    <option value="3">KE
    <option value="4">TO
    <option value="5">PE
    <option value="6">LA
    <option value="0">SU
</select>
aika: <input type="time" name="weekly_time_start"> - <input type="time" name="weekly_time_end">
<p>
    <input type="submit" value="Tallenna muutokset">
<p>
Vakioaikani:
<Ul>
    {% if own_weekly_entries %}
    {% for entry in own_weekly_entries %}
    <li>{{days[entry[0]]}} {{entry[2]}} klo {{entry[3].strftime('%H:%M')}} - {{entry[4].strftime('%H:%M')}}
        <a href="/entry/weekly/{{entry[5]}}">  muuta</a>
    </li>
#TÄHÄN linkki ilmoittautumiseen, jossa voi muuttaa tai perua vakioajan, entry[5] on vakioajan entry id sillä update tai delete
    {% endfor %}
{% endif %}
</Ul>
<p>
</form>
<hr>
<!------------------------------------------------------------------->
<form action="/settings/change_calendarview" method="POST">
<h2 style="color:green">Kalenterinäkymässä näkyvät tapahtumat</h2>
<p>
Tässä voit valita tapahtumat, jotka näkyvät kalenteriisi
<p>
Tapahtuman nimi:
<p>
    {% for event in events_with_own_level %}
    <!-- vvvvv saako tähän on pienempi kuin neljä vvvvv miten escape-->
    {% if event[6] == 2 %}
    <input type="checkbox" name="event_pick" value="{{event[0]}}" checked > <label for="event_pick"> {{event[1]}} taso {{event[5]}} {{event[2]}} </label><br>
    {% else %}
    <input type="checkbox" name="event_pick" value="{{event[0]}}" > <label for="event_pick"> {{event[1]}} taso {{event[5]}} {{event[2]}} </label><br>
    {% endif %}
    {% endfor %}    
</select>
<p>
<input type="submit" value="Tallenna muutokset">
<p>
</form>
<hr>
<!------------------------------------------------------------------>
<form action="/settings/friends" method="POST">
<h2>Lisää kavereita</h2>
Voit seurata kavereidesi alustavia toisen viikon suunnitelmia.<br>
<b>Lähetä kaveripyyntö, anna kaverisi kalenterissa oleva nimi: </b><br>
<input type="text" name="friend">
<p>
#tämä vielä kesken.. friends forever! .. :D<br>
<b>Hyväksy kaveripyyntöjä ja poista kavereita: </b><br>
    {% if friend_requests %}
  Kaveripyynnöt:<br>
  {% for friend_asking in friend_requests %}
      <input type="checkbox" name="friends" value="{{friend_asking[0]}}" >{{friend_asking[1]}} <br>
  {% endfor %}
{% endif %}

{% if friends %}
  Kaverisi:<br>
  {% for friend in friends %}
    <input type="checkbox" name="friends" value="{{friend[0]}}" checked >{{friend[1]}} <br>
{% endfor %}
{% endif %}
<p>
<input type="submit" value="Tallenna muutokset">
<p>
</form>
<hr>
<!-------------------------------------------------------------------------->
<!--form action="/settings/report_entries" method="POST">
TÄHÄN raporttipyyntö osallistumisista ... tee jos ehdit, vakioajat vaatii lisätaulun jos..
RAPORTTI tapahtumannimi..ajalta pvm - pvm
<h2>Osallistumisraportti</h2>
<p>
<form action="/entry_report" method="POST">
Hae ajalta: <input type="date" name="date_start"> - <input type="date" name="date_end">
<p>
<input type="submit" value="Hae">
<p>
</form>
<hr>-->
<!-------------------------------------------------------------------------->
<!-------------ADMIN--------------------------------------------------------->
<!-- tästä alkaa varsinaisesti adminin/ryhmän perustajan asetukset, kun jäsenen asetuksista loputkin toiminnaltaan täysin varmoja-->

<form action="/settings/change_group_name" method="POST">

    <h2 >Ryhmän hallinta -admin</h2>
<p>
    <hr>
    <p>
    <b style="color:green">Muuta ryhmän nimi</b> <br>
    Anna uusi nimi:<br>
    <input type="text" name="name_group" minlength="2" maxlength="30">
     <p>
        <input type="submit" value="Tallenna muutos">
        <p>
            <input type="hidden" name="csrf_token" value="{{session.csrf_token}}">
        </form>
    <p>
    <!--------------------------------------------------------------------------->
    <form action="/settings/change_group_description" method="POST">
        <b style="color:green">Muuta ryhmän kuvaus</b><br>
        Ryhmän kuvaus: <br><textarea name ="group_description" rows="3" cols="50" maxlength="400">
        </textarea>
           <p>
               <input type="hidden" name="csrf_token" value="{{session.csrf_token}}">
<p>
        <input type="submit" value="Tallenna muutos">
        <p>
        </form>
    <!--------------------------------------------------------------------->
    <form action="/settings/change_group_password" method="POST">
    <b style="color:green">Salasanan vaihto:</b><br>
    Huom! muuta takaisin ryhmän salasanaksi tsoha jos kokeilet.. :)
    <p>
    Oma kirjautumissalasanasi:<br><input type="password" name="old_password">
    <p>
    Uusi ryhmän salasana:<br><input type="password" name="new_password1">
    <p>
    Uusi ryhmän salasana uudelleen: <br><input type="password" name="new_password2">
    <input type="hidden" name="csrf_token" value="{{session.csrf_token}}">
    <p>
    <input type="submit" value="Tallenna muutos">
    <p>
    </form>
    <hr>
<!--------------------------------------------------------------------------->
<form action="/settings/add_new_event" method="POST">
<h2 style="color: green">Uuden tapahtuman luominen:</h2>
<b>Anna tapahtuman nimi: <input type="text" name="new_event_name" minlength="1" maxlength="30"></b>
<p>
<b>..voit halutessasi antaa lisätietoa:</b>
<p>
Anna tapahtuman kuvaus: <textarea name="new_event_description" rows="2" cols="50" maxlength="150">
</textarea>
<p>
Anna minimiosallistujamäärä: <input type="number" name="new_event_min_participants" min="0" max="99999">
<p>
Anna maksimiosallistujamäärä: <input type="number" name="new_event_max_participants" min="0" max="99999">
<p>
<b>..ja rajata osallistujille oman taitotason tapahtumia:</b>
<p>
Anna tapahtumaan vaadittava (taito)taso: <input type="number" name="new_event_level" min="0" max="99"><br>
<p>
    Huom! Mikäli käytit tasoasetuksia, päivitä tapahtuman kohderyhmän jäsenille riittävä taso tapahtumaan 
    jäsenten asetuksissa tapahtuman tietojen tallentamisen jälkeen <br>
    <a style="color:green" href="/settings/admin/userlist">pääset tästä jäsenten asetuksiin</a>
    <p>Jäsenillä on oletuksena oikeus ilmoittautua nollatason tapahtumiin.
    Esim. jos määrittelet jäsenelle tason 5, niin jäsen näkee kaikki tapahtumat tasoilla 0-5
    ja voi omissa asetuksissaan valita näistä tapahtumista itselleen sopivat tapahtumat kalenterissa näytettäväksi.
<p>
    <input type="submit" value="Tallenna uuden tapahtuman tiedot">
    <p>
    </form>
    <hr>
<!------------------------------------------------------------------------------------------------>
<form action="/settings/change_event_info" method="POST">
<h2 style="color:green">Tapahtuman muuttaminen tai poistaminen käytöstä</h2>
<p>
<p><b>valitse tapahtuma:</b>
<select name="event_pick">
    {% for event in all_events %}
<option value="{{event[0]}}"> {{event[1]}} | taso {{event[5]}}
    {% endfor %}
</select>
  <b>valitse toiminto:</b>
<select name="event_action">
<option value="2"> muuta nimi
<option value="3"> muuta kuvaus
<option value="4"> muuta minimiosallistujamäärä
<option value="5"> muuta maksimiosallistujamäärä
<option value="6"> muuta tasomääritys
<option value="1"> poista käytöstä*
</select>
<p>
    *käytöstä poistetut tapahtumat (taso 100) voidaan ottaa uudelleen käyttöön muuttamalla tasomääritys normaaliksi, myös muita tapahtuman tietoja voi muutella.
<!--tässä bugivaara.. jos tapahtuma muutetaan kokonaan toiseksi, niin siihen täytyy olla vielä users in events -lisäkäsittelyä, joten erikseen toimintoihin vielä-->
<br><b>Täytä vain valintaasi vastaava kenttä:</b><br>
muuta nimi: <input type="text" name="event_name" minlength="1" maxlength="35">
<p>
muuta kuvaus: <textarea name="event_description" rows="2" cols="50" maxlength="150">
</textarea>
<p>
minimi- tai maksimiosallistujamäärä: <input type="number" name="number_value1" min="0" max="99999">
<p>
muuta taso: <input type="number" name="number_value2" min="0" max="99">
<p>
<input type="submit" value="Tallenna muutokset">
<p>
</form>
<hr>
<!---------------------------------------------------------------------->
<form action="/settings/admin/message" method="POST">
<h2 style="color: green">Admin -viesti</h2>
Lyhyt viesti, joka näkyy jäsenille ensimmäisen viikon näkymässä ja on päivitettävissä.
<br> Viesti: <input type="text" name="admin_info">
<p>
<input type="submit" value="Tallenna viesti">
<p>
</form>
<hr>
<!----------------------------------------------------------------------------->
<form action="/settings/admin/management_users" method="POST">
<h2>Jäsenten hallinta</h2>
<!--##tämä vielä keskeneräinen: haku ja jäsenlistan järjestyksen muokkaus vai linkki? nyt linkki toimii.. -->
<p>
    <a style="color:green" href="/settings/admin/userlist">Tarkastele ja muuta jäsenien asetuksia</a>
<p>
voit mm.:
<ul>
    <li>resetoida unohtuneen salasanan, salasanaksi vaihtuu jäsenen käyttämä tunnus, kunnes jäsen itse vaihtaa sen asetuksissa.
    <li>muuttaa jäsenen tasoa tapahtumakohtaisesti, mikäli tasot ovat käytössä, oletustasona jäsenellä on 0
    <li>muuttaa tarvittaessa jäsenen roolin adminiksi
    <li>poistaa jäsenen tapahtumasta ja lisätä takaisin
    <li>estää jäsen kaikista tapahtumistaan ja palauttaa oikeudet kaikkiin tapahtumiinsa</li>    
</ul>
<p>
<!--<input type="submit" value="Hae jäsenet">   ..odottelee jäsenlistan sorttausominaisuutta-->
<p>
</form>
<hr>
{% endif %}
{% endblock %}